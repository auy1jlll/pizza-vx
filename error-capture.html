<!DOCTYPE html>
<html>
<head>
    <title>Error Capture</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f0f0f0; }
        .button { padding: 15px 30px; margin: 10px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        .button:hover { background: #0056b3; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #cce7ff; color: #004085; }
    </style>
</head>
<body>
    <h1>üîç Browser Error Capture Tool</h1>
    <p>This will capture browser console errors and save them to a file that Claude can read.</p>
    
    <button class="button" onclick="startCapture()">1. Start Error Capture</button>
    <button class="button" onclick="testMainApp()">2. Open Main App & Capture Errors</button>
    <button class="button" onclick="saveErrors()">3. Save Errors to File</button>
    
    <div id="status"></div>
    <iframe id="appFrame" style="display:none; width:100%; height:400px; border:1px solid #ccc; margin-top:20px;"></iframe>

    <script>
        let errors = [];
        let capturing = false;
        
        function showStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        function startCapture() {
            if (capturing) return;
            capturing = true;
            errors = [];
            
            // Capture console errors
            const originalError = console.error;
            const originalWarn = console.warn;
            
            console.error = function(...args) {
                const error = `ERROR: ${args.map(a => String(a)).join(' ')}`;
                errors.push(`[${new Date().toISOString()}] ${error}`);
                originalError.apply(console, args);
            };
            
            console.warn = function(...args) {
                const warning = `WARNING: ${args.map(a => String(a)).join(' ')}`;
                errors.push(`[${new Date().toISOString()}] ${warning}`);
                originalWarn.apply(console, args);
            };
            
            // Capture window errors
            window.addEventListener('error', function(e) {
                const error = `SCRIPT_ERROR: ${e.message} at ${e.filename}:${e.lineno}:${e.colno}`;
                errors.push(`[${new Date().toISOString()}] ${error}`);
            });
            
            // Capture promise rejections
            window.addEventListener('unhandledrejection', function(e) {
                const error = `PROMISE_REJECTION: ${String(e.reason)}`;
                errors.push(`[${new Date().toISOString()}] ${error}`);
            });
            
            showStatus('‚úÖ Error capture started! Now click "Open Main App & Capture Errors"', 'success');
        }
        
        function testMainApp() {
            if (!capturing) {
                showStatus('‚ùå Please start error capture first!', 'error');
                return;
            }
            
            showStatus('üîÑ Loading main app to capture errors...', 'info');
            
            const iframe = document.getElementById('appFrame');
            iframe.style.display = 'block';
            iframe.src = 'http://localhost:3007';
            
            // Wait a bit then check for errors
            setTimeout(() => {
                if (errors.length > 0) {
                    showStatus(`üìä Captured ${errors.length} errors! Click "Save Errors to File"`, 'success');
                } else {
                    showStatus('‚ÑπÔ∏è No errors captured yet. Try navigating around the app, then wait a moment and save.', 'info');
                }
            }, 5000);
        }
        
        function saveErrors() {
            if (errors.length === 0) {
                showStatus('‚ö†Ô∏è No errors to save. Make sure you started capture and loaded the main app.', 'error');
                return;
            }
            
            const errorText = [
                '=== BROWSER CONSOLE ERRORS ===',
                `Captured at: ${new Date().toISOString()}`,
                `Total errors: ${errors.length}`,
                '================================',
                '',
                ...errors,
                '',
                '=== END OF ERRORS ==='
            ].join('\\n');
            
            const blob = new Blob([errorText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'browser-console-errors.txt';
            a.style.display = 'none';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showStatus(`‚úÖ Errors saved to browser-console-errors.txt in your Downloads folder! Tell Claude the file is ready.`, 'success');
        }
        
        // Auto-start
        showStatus('Click "Start Error Capture" to begin', 'info');
    </script>
</body>
</html>